[{"authors":["admin"],"categories":null,"content":"Sören Wilke is a geoscientist and mineralogist working as a project engineer at AKVO Jungk Consult GmbH. His focus areas include the more complex aspects of hydrogeochemical interdependencies in contaminated soils and groundwater bodies as well as modelling the geological geometries controlling contaminant flows.\n","date":1548979200,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":1548979200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"Sören Wilke is a geoscientist and mineralogist working as a project engineer at AKVO Jungk Consult GmbH. His focus areas include the more complex aspects of hydrogeochemical interdependencies in contaminated soils and groundwater bodies as well as modelling the geological geometries controlling contaminant flows.","tags":null,"title":"Sören Wilke","type":"authors"},{"authors":null,"categories":null,"content":"Flexibility This feature can be used for publishing content such as:\n Online courses Project or software documentation Tutorials  The courses folder may be renamed. For example, we can rename it to docs for software/project documentation or tutorials for creating an online course.\nDelete tutorials To remove these pages, delete the courses folder and see below to delete the associated menu link.\nUpdate site menu After renaming or deleting the courses folder, you may wish to update any [[main]] menu links to it by editing your menu configuration at config/_default/menus.toml.\nFor example, if you delete this folder, you can remove the following from your menu configuration:\n[[main]] name = \u0026quot;Courses\u0026quot; url = \u0026quot;courses/\u0026quot; weight = 50  Or, if you are creating a software documentation site, you can rename the courses folder to docs and update the associated Courses menu configuration to:\n[[main]] name = \u0026quot;Docs\u0026quot; url = \u0026quot;docs/\u0026quot; weight = 50  Update the docs menu If you use the docs layout, note that the name of the menu in the front matter should be in the form [menu.X] where X is the folder name. Hence, if you rename the courses/example/ folder, you should also rename the menu definitions in the front matter of files within courses/example/ from [menu.example] to [menu.\u0026lt;NewFolderName\u0026gt;].\n","date":1536451200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1536451200,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"/courses/example/","publishdate":"2018-09-09T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"Learn how to use Academic's docs layout for publishing online courses, software documentation, and tutorials.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":null,"content":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 2 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"74533bae41439377bd30f645c4677a27","permalink":"/courses/example/example1/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example1/","section":"courses","summary":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":null,"title":"Example Page 1","type":"docs"},{"authors":null,"categories":null,"content":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 4 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"1c2b5a11257c768c90d5050637d77d6a","permalink":"/courses/example/example2/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example2/","section":"courses","summary":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":null,"title":"Example Page 2","type":"docs"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Academic\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further talk details can easily be added to this page using Markdown and $\\rm \\LaTeX$ math code.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906549200,"objectID":"96344c08df50a1b693cc40432115cbe3","permalink":"/talk/example/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example/","section":"talk","summary":"An example talk using Academic's Markdown slides feature.","tags":[],"title":"Example Talk","type":"talk"},{"authors":[],"categories":[],"content":"\r\r\r\r\r\r\r\r\r\r\r\rOne of the most exciting things you can to with R is geospatial interpolation. This means that you have some kind of information (e.g. measurements of, say, soil temperature) for a limited number of locations and then you apply a mathematical model that will provide you with an educated guess of what your result might look like, if you would have measured at every possible location. The practical advantage is clear. Sampling is expensive and therefore always limited. This is especially true in the geosciences, where sampling might require hundreds of thousands of Euros for drilling deep holes to the formation of your interest.\nDoing your geospatial interpolation in R is a great opportunity. Many software tools often associated with that task are commercial products that can become fairly expensive, so it is pretty common that if one finishes university or changes a job position, all the work spend on learning that tool is rendered void. R on the other hand is always free and offers a wide range of algorithms of all kinds of flavours. An additional bonus is the seamless integration with the powerful data transformation and visualization capabilities of the language.\nA problem when using R (especially at the beginning) is, that the user interface for the application of different algorithms on the many available data structures varies wildly. Although improvements clearly have been made in the recent years, there is little standardization and every package author basically comes up with their own philosophy on how to handle input/output.\nAs a consequence, starting with geospatial interpolation in R can be frustrating. Of course you can (and will have to) dig through the documentation of the various packages, but as interpolation models are a fairly advanced topic of statistics, those tend to be heavy on technical slang.\nThere are a couple of good blog posts (see here, here and here) on geospatial interpolation, but they either focus on dealing with specific package interfaces or are again written for an audience that is already well versed in the world of spatial data.\nWhen I started to learn about geospatial interpolation with R a couple of years ago, I found it difficult to get up to speed with real world data. Most use cases I found focuses on pre-treated datasets whose conditions I could not sensibly reproduce with my own data or made steps that seemed outright incomprehensible at that time. So I feel like there is a documentation gap for a practical guide of the very basics of geospatial interpolation: how do I get from having a bunch of field observations to a regular raster of interpolated values that I can plot on a nice little map? I am going to present you here with a minimalistic workflow designed to step-by-step explain the principles behind the necessary operations that all approaches for geospatial interpolation with R have in common. That way I hope your entrance into this fascinating world will be more pleasent than mine was.\nThere are four steps to Geospatial interpolation\r0. Have some data\r1. Create a grid template\r2. Fit a model\r3. Interpolate!\nSo let’s start!\nlibrary(tidyverse) # data wrangling and plotting\rlibrary(sf) # processing spatial vector data\rlibrary(raster) # processing spatial raster data. !!!overwrites dplyr::select!!!\rlibrary(mapview) # inspecting your data in OpenStreetMaps\r# Download the data for this tutorial from Github\r# Data is provided by the senate of the city of Berlin under:\r# dl-de/by-2-0 Umweltatlas Berlin / Grundwassergüte Ammonium (Umweltatlas)\r# for more details see: http://www.stadtentwicklung.berlin.de/umwelt/umweltatlas/ia204.htm\rpts_NH4 \u0026lt;- readr::read_csv(\r\u0026quot;https://raw.githubusercontent.com/Ignimbrit/exchange/master/data/2020/Ammonium_Hoppegarten.csv\u0026quot;,\rcol_types = cols(NH4 = col_double(), X = col_double(), Y = col_double(), fid = col_character(), licence = col_character())\r) %\u0026gt;% dplyr::select(X, Y, NH4)\rprint(pts_NH4)\r## # A tibble: 64 x 3\r## X Y NH4\r## \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 406521. 5814334. 2.3\r## 2 409320. 5814598. 20.2\r## 3 410322. 5814606. 0.3\r## 4 408804. 5814825. 4.1\r## 5 409049. 5814830. 2.5\r## 6 408701. 5814896. 11.3\r## 7 408843. 5814898. 16.1\r## 8 409022. 5814928. 3 ## 9 408865. 5814943. 12 ## 10 408729. 5814949. 24.4\r## # ... with 54 more rows\rIn the chunk above we already solved Step 0: Have some data! For this tutorial I compiled a little demonstration dataset (see comments for the source) that you can download from github to follow my steps. The data comes from a csv that contains 64 measurments of Ammonium in groundwater from a former septic drain field (“Rieselfeld”) at a place called Hoppegarten at the outer rim of Berlin. Ammonium in groundwater can be a problem, so it would be good to know exactly how big our problem is, which can hardly be assessed by a coulpe of randomly scattered points per se.\nsf_NH4 \u0026lt;- st_as_sf(pts_NH4, coords = c(\u0026quot;X\u0026quot;, \u0026quot;Y\u0026quot;), crs = 25833)\rmapview(sf_NH4, map.types = \u0026quot;OpenTopoMap\u0026quot;)\r\r{\"x\":{\"options\":{\"minZoom\":1,\"maxZoom\":52,\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"preferCanvas\":false,\"bounceAtZoomLimits\":false,\"maxBounds\":[[[-90,-370]],[[90,370]]]},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"OpenTopoMap\",1,\"OpenTopoMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"createMapPane\",\"args\":[\"point\",440]},{\"method\":\"addCircleMarkers\",\"args\":[[52.4711550830412,52.4739988271146,52.4742361141437,52.4759523218643,52.4760380917416,52.4765729873907,52.4766146721525,52.4769140395776,52.4770226284752,52.4770538245006,52.4772677021166,52.4772923596518,52.4774865815009,52.4775036244707,52.4774894057095,52.4777612675227,52.4779657935749,52.4779610892255,52.477908993591,52.4787164799449,52.4788240276573,52.4789961412726,52.4793240861093,52.4826915580302,52.4846572154495,52.4863524320888,52.4916815508104,52.4921786439067,52.4789993544158,52.4821725885026,52.4796385362496,52.4785794598726,52.4753355468452,52.4746166809563,52.4664207108631,52.4852458475374,52.4714058017703,52.4652962107197,52.4771499242226,52.466505520906,52.4686746674343,52.4593437532016,52.4711298520393,52.4601820954265,52.4764373323917,52.4775353751698,52.4859545419436,52.484536106997,52.463854739858,52.4844009632796,52.4725219942496,52.4658541069132,52.4839678124883,52.4853078099432,52.4850733761224,52.4862585629144,52.4876340561591,52.4889221171977,52.4880641557427,52.4782336049084,52.4796750191702,52.473079661278,52.4669600839075,52.4786153890073],[13.623809829169,13.6649304555596,13.679670362294,13.6572767306591,13.6608800971448,13.6557418401419,13.6578305925656,13.6604561083459,13.6581419909584,13.6561393103799,13.658355317144,13.6597381242206,13.6673859735713,13.6585542050985,13.6565087299651,13.6567065147451,13.6580985843624,13.656891776349,13.6515209620873,13.6585173250174,13.6561148241834,13.6546523736262,13.6589993066688,13.6484895351108,13.6561579120681,13.6448294129405,13.6346389132681,13.6545004959896,13.652388435077,13.6474151638176,13.6464719957152,13.6352563440089,13.6306640141182,13.6256896833238,13.6337237368213,13.6482409422315,13.6518836858188,13.6448176510628,13.641937859845,13.6620188768533,13.6478502799037,13.6601153462301,13.6237031603673,13.6491408677428,13.6560368520403,13.6482077470253,13.6542472696972,13.6471218708289,13.6611192539329,13.6490354115493,13.6406412514473,13.639182480121,13.6571016870993,13.6529220366772,13.6562486739304,13.6546398937568,13.6550749302418,13.6541434586164,13.6568608777054,13.6599824607045,13.6429395846224,13.6354171600859,13.6293537046671,13.6354918402457],6,null,\"sf_NH4\",{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"pane\":\"point\",\"stroke\":true,\"color\":\"#333333\",\"weight\":2,\"opacity\":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],\"fill\":true,\"fillColor\":[\"#481F70\",\"#3D4D8A\",\"#481467\",\"#482576\",\"#481F70\",\"#443A83\",\"#414487\",\"#481F70\",\"#443A83\",\"#375B8D\",\"#31688E\",\"#481F70\",\"#463480\",\"#472A7A\",\"#35608D\",\"#32648E\",\"#3B528B\",\"#463480\",\"#35608D\",\"#27808E\",\"#35B779\",\"#20A486\",\"#2B748E\",\"#1E9C89\",\"#481467\",\"#35608D\",\"#481467\",\"#481467\",\"#482576\",\"#481467\",\"#25AC82\",\"#443A83\",\"#482576\",\"#481A6C\",\"#482576\",\"#DEE318\",\"#423F85\",\"#481F70\",\"#3F4889\",\"#481A6C\",\"#481467\",\"#481467\",\"#481467\",\"#423F85\",\"#481467\",\"#32648E\",\"#481467\",\"#22A884\",\"#375B8D\",\"#25848E\",\"#2A788E\",\"#3D4D8A\",\"#481467\",\"#481A6C\",\"#481467\",\"#481467\",\"#481467\",\"#472F7D\",\"#481467\",\"#463480\",\"#287C8E\",\"#472F7D\",\"#481467\",\"#481A6C\"],\"fillOpacity\":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,[\"Feature ID1\u0026emsp;1NH4\u0026emsp;2.30000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID2\u0026emsp;1NH4\u0026emsp;20.20000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID3\u0026emsp;1NH4\u0026emsp;0.30000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID4\u0026emsp;1NH4\u0026emsp;4.10000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID5\u0026emsp;1NH4\u0026emsp;2.50000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID6\u0026emsp;1NH4\u0026emsp;11.30000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID7\u0026emsp;1NH4\u0026emsp;16.10000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID8\u0026emsp;1NH4\u0026emsp;3.00000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID9\u0026emsp;1NH4\u0026emsp;12.00000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID10\u0026emsp;1NH4\u0026emsp;24.40000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID11\u0026emsp;1NH4\u0026emsp;31.00000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID12\u0026emsp;1NH4\u0026emsp;3.10000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID13\u0026emsp;1NH4\u0026emsp;10.60000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID14\u0026emsp;1NH4\u0026emsp;6.40000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID15\u0026emsp;1NH4\u0026emsp;27.00000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID16\u0026emsp;1NH4\u0026emsp;27.70000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID17\u0026emsp;1NH4\u0026emsp;21.30000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID18\u0026emsp;1NH4\u0026emsp;11.00000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID19\u0026emsp;1NH4\u0026emsp;27.00000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID20\u0026emsp;1NH4\u0026emsp;40.80000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID21\u0026emsp;1NH4\u0026emsp;65.70000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID22\u0026emsp;1NH4\u0026emsp;57.80000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID23\u0026emsp;1NH4\u0026emsp;36.10000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID24\u0026emsp;1NH4\u0026emsp;53.40000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID25\u0026emsp;1NH4\u0026emsp;0.30000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID26\u0026emsp;1NH4\u0026emsp;27.40000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID27\u0026emsp;1NH4\u0026emsp;0.20000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID28\u0026emsp;1NH4\u0026emsp;0.20000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID29\u0026emsp;1NH4\u0026emsp;4.96735\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID30\u0026emsp;1NH4\u0026emsp;0.22950\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID31\u0026emsp;1NH4\u0026emsp;60.27200\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID32\u0026emsp;1NH4\u0026emsp;11.35128\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID33\u0026emsp;1NH4\u0026emsp;4.19643\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID34\u0026emsp;1NH4\u0026emsp;1.85165\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID35\u0026emsp;1NH4\u0026emsp;5.29593\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID36\u0026emsp;1NH4\u0026emsp;96.10500\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID37\u0026emsp;1NH4\u0026emsp;13.68027\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID38\u0026emsp;1NH4\u0026emsp;2.48480\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID39\u0026emsp;1NH4\u0026emsp;18.24133\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID40\u0026emsp;1NH4\u0026emsp;1.61118\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID41\u0026emsp;1NH4\u0026emsp;0.09141\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID42\u0026emsp;1NH4\u0026emsp;0.46225\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID43\u0026emsp;1NH4\u0026emsp;0.22436\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID44\u0026emsp;1NH4\u0026emsp;14.61633\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID45\u0026emsp;1NH4\u0026emsp;0.11756\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID46\u0026emsp;1NH4\u0026emsp;27.52000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID47\u0026emsp;1NH4\u0026emsp;0.09872\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID48\u0026emsp;1NH4\u0026emsp;58.51800\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID49\u0026emsp;1NH4\u0026emsp;24.17933\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID50\u0026emsp;1NH4\u0026emsp;42.54188\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID51\u0026emsp;1NH4\u0026emsp;37.27400\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID52\u0026emsp;1NH4\u0026emsp;18.77429\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID53\u0026emsp;1NH4\u0026emsp;0.36212\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID54\u0026emsp;1NH4\u0026emsp;0.96087\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID55\u0026emsp;1NH4\u0026emsp;0.06925\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID56\u0026emsp;1NH4\u0026emsp;0.17875\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID57\u0026emsp;1NH4\u0026emsp;0.02000\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID58\u0026emsp;1NH4\u0026emsp;7.69327\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID59\u0026emsp;1NH4\u0026emsp;0.04515\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID60\u0026emsp;1NH4\u0026emsp;9.99750\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID61\u0026emsp;1NH4\u0026emsp;38.71933\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID62\u0026emsp;1NH4\u0026emsp;9.41357\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID63\u0026emsp;1NH4\u0026emsp;0.24296\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\",\"Feature ID64\u0026emsp;1NH4\u0026emsp;1.60093\u0026emsp;2geometry\u0026emsp;sfc_POINT\u0026emsp;\"],{\"maxWidth\":800,\"minWidth\":50,\"autoPan\":true,\"keepInView\":false,\"closeButton\":true,\"closeOnClick\":true,\"className\":\"\"},[\"2.3\",\"20.2\",\"0.3\",\"4.1\",\"2.5\",\"11.3\",\"16.1\",\"3\",\"12\",\"24.4\",\"31\",\"3.1\",\"10.6\",\"6.4\",\"27\",\"27.7\",\"21.3\",\"11\",\"27\",\"40.8\",\"65.7\",\"57.8\",\"36.1\",\"53.4\",\"0.3\",\"27.4\",\"0.2\",\"0.2\",\"4.96735\",\"0.2295\",\"60.272\",\"11.35128\",\"4.19643\",\"1.85165\",\"5.29593\",\"96.105\",\"13.68027\",\"2.4848\",\"18.24133\",\"1.61118\",\"0.09141\",\"0.46225\",\"0.22436\",\"14.61633\",\"0.11756\",\"27.52\",\"0.09872\",\"58.518\",\"24.17933\",\"42.54188\",\"37.274\",\"18.77429\",\"0.36212\",\"0.96087\",\"0.06925\",\"0.17875\",\"0.02\",\"7.69327\",\"0.04515\",\"9.9975\",\"38.71933\",\"9.41357\",\"0.24296\",\"1.60093\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addScaleBar\",\"args\":[{\"maxWidth\":100,\"metric\":true,\"imperial\":true,\"updateWhenIdle\":true,\"position\":\"bottomleft\"}]},{\"method\":\"addHomeButton\",\"args\":[13.6237031603673,52.4593437532016,13.679670362294,52.4921786439067,\"sf_NH4\",\"Zoom to sf_NH4\",\" sf_NH4 \",\"bottomright\"]},{\"method\":\"addLayersControl\",\"args\":[\"OpenTopoMap\",\"sf_NH4\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154 , #482677 10.3866368319717%, #404688 20.7940885674143%, #33638E 31.2015403028568%, #287C8E 41.6089920382994%, #1F958C 52.016443773742%, #27AD81 62.4238955091846%, #52C469 72.8313472446272%, #8ED744 83.2387989800697%, #D4E21A 93.6462507155123%, #FDE725 \"],\"labels\":[\"10\",\"20\",\"30\",\"40\",\"50\",\"60\",\"70\",\"80\",\"90\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"topright\",\"type\":\"numeric\",\"title\":\"sf_NH4\",\"extra\":{\"p_1\":0.103866368319717,\"p_n\":0.936462507155123},\"layerId\":null,\"className\":\"info legend\",\"group\":\"sf_NH4\"}]}],\"limits\":{\"lat\":[52.4593437532016,52.4921786439067],\"lng\":[13.6237031603673,13.679670362294]}},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"function(el, x, data) {\\n return (\\n function(el, x, data) {\\n // get the leaflet map\\n var map = this; //HTMLWidgets.find('#' + el.id);\\n // we need a new div element because we have to handle\\n // the mouseover output separately\\n // debugger;\\n function addElement () {\\n // generate new div Element\\n var newDiv = $(document.createElement('div'));\\n // append at end of leaflet htmlwidget container\\n $(el).append(newDiv);\\n //provide ID and style\\n newDiv.addClass('lnlt');\\n newDiv.css({\\n 'position': 'relative',\\n 'bottomleft': '0px',\\n 'background-color': 'rgba(255, 255, 255, 0.7)',\\n 'box-shadow': '0 0 2px #bbb',\\n 'background-clip': 'padding-box',\\n 'margin': '0',\\n 'padding-left': '5px',\\n 'color': '#333',\\n 'font': '9px/1.5 \\\"Helvetica Neue\\\", Arial, Helvetica, sans-serif',\\n 'z-index': '700',\\n });\\n return newDiv;\\n }\\n\\n\\n // check for already existing lnlt class to not duplicate\\n var lnlt = $(el).find('.lnlt');\\n\\n if(!lnlt.length) {\\n lnlt = addElement();\\n\\n // grab the special div we generated in the beginning\\n // and put the mousmove output there\\n\\n map.on('mousemove', function (e) {\\n if (e.originalEvent.ctrlKey) {\\n if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n lnlt.text(\\n ' lon: ' + (e.latlng.lng).toFixed(5) +\\n ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n ' | zoom: ' + map.getZoom() +\\n ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\\n ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\\n ' | epsg: 3857 ' +\\n ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\\n } else {\\n if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n lnlt.text(\\n ' lon: ' + (e.latlng.lng).toFixed(5) +\\n ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n ' | zoom: ' + map.getZoom() + ' ');\\n }\\n });\\n\\n // remove the lnlt div when mouse leaves map\\n map.on('mouseout', function (e) {\\n var strip = document.querySelector('.lnlt');\\n strip.remove();\\n });\\n\\n };\\n\\n //$(el).keypress(67, function(e) {\\n map.on('preclick', function(e) {\\n if (e.originalEvent.ctrlKey) {\\n if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n lnlt.text(\\n ' lon: ' + (e.latlng.lng).toFixed(5) +\\n ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n ' | zoom: ' + map.getZoom() + ' ');\\n var txt = document.querySelector('.lnlt').textContent;\\n console.log(txt);\\n //txt.innerText.focus();\\n //txt.select();\\n setClipboardText('\\\"' + txt + '\\\"');\\n }\\n });\\n\\n }\\n ).call(this.getMap(), el, x, data);\\n}\",\"data\":null}]}}\rlibrary(tidyverse)\rlibrary(mapview)\rlibrary(sf)\rlibrary(raster)\rpts_NH4 \u0026lt;- readr::read_csv(\r\u0026quot;https://raw.githubusercontent.com/Ignimbrit/exchange/master/data/2020/Ammonium_Hoppegarten.csv\u0026quot;,\rcol_types = cols(NH4 = col_double(), X = col_double(), Y = col_double(), fid = col_character(), licence = col_character())\r) %\u0026gt;% select(X, Y, NH4)\rsf_NH4 \u0026lt;- st_as_sf(pts_NH4, coords = c(\u0026quot;X\u0026quot;, \u0026quot;Y\u0026quot;), crs = 25833)\rmapview(sf_NH4, map.types = \u0026quot;OpenTopoMap\u0026quot;)\rbbox \u0026lt;- c(\r\u0026quot;xmin\u0026quot; = min(pts_NH4$X),\r\u0026quot;ymin\u0026quot; = min(pts_NH4$Y),\r\u0026quot;xmax\u0026quot; = max(pts_NH4$X),\r\u0026quot;ymax\u0026quot; = max(pts_NH4$Y)\r)\rgrd_template \u0026lt;- expand.grid(\rX = seq(from = bbox[\u0026quot;xmin\u0026quot;], to = bbox[\u0026quot;xmax\u0026quot;], by = 20),\rY = seq(from = bbox[\u0026quot;ymin\u0026quot;], to = bbox[\u0026quot;ymax\u0026quot;], by = 20) # 20 m resolution\r)\rraster_template \u0026lt;- grd_template %\u0026gt;% mutate(Z = 0) %\u0026gt;% rasterFromXYZ( # {raster} expects a PROJ.4 string, see https://epsg.io/25833\rcrs = \u0026quot;+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\u0026quot;)\r#########\rlibrary(fields)\rm \u0026lt;- fields::Tps(x = as.matrix(select(pts_NH4, X, Y)), Y = pts_NH4$NH4, miles = FALSE)\rr \u0026lt;- interpolate(raster_template, m)\rtest \u0026lt;- st_as_sf(pts_NH4, coords = c(\u0026quot;X\u0026quot;, \u0026quot;Y\u0026quot;), crs = 25833)\rtest2 \u0026lt;- st_as_sf(mutate(grd_template, id = seq(1, nrow(grd_template))), coords = c(\u0026quot;X\u0026quot;, \u0026quot;Y\u0026quot;), crs = 25833)\r","date":1590019200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1590077360,"objectID":"8c432740a5c08928bba67db22a39801b","permalink":"/post/spatial_interpolation/","publishdate":"2020-05-21T00:00:00Z","relpermalink":"/post/spatial_interpolation/","section":"post","summary":"One of the most exciting things you can to with R is geospatial interpolation. This means that you have some kind of information (e.","tags":[],"title":"A practical guide to geospatial interpolation with R","type":"post"},{"authors":[],"categories":[],"content":"\r\rPreface\rPreparing Input Data\rExample 1: Experimental Data set\rExample 2: Thermodynamic Model (MELTS) Data set\rConcluding Remarks\r\r\rPreface\rIn petrology it is common to be confronted with or thinking about mineral phase stability. Which minerals form in a certain spot (of melt) is a complex matter depending not only on the chemical composition but also on a multitude of physical factors. The most prominent parameters are probably temperature and pressure, but they are far from being the only variables.\nFor example there is oxygen fugacity, a somewhat arcane concept describing the level of oxidation of a magma, which potentially has a huge impact on the phase assemblage that forms. Michael Anenburg has been writing a lot about this fascinating topic and highly recommend his Twitter tutorials.\nA small oxygen fugacity thread. There\u0026#39;s a common misconception that ƒO₂ = pO₂ (i.e. partial pressure of oxygen).\nLet\u0026#39;s have a look at some numbers. pic.twitter.com/fAJqlIbOCJ\n\u0026mdash; Michael Anenburg (@manenbu) April 19, 2020  But I am digressing. Phase stability data, by and at large, can be obtained mostly through three ways:\nYou can do an petrological experiment. You put some rock powder into what is basically a very sophisticated oven and have total control over the parameters (well, in theory, at least). The downside is that this approach is slow and laborious. Access to experimental facilities is restricted and operating pressure vessels requires special training. Also some of them have a tendency to explode and wreck varying degrees of havoc along the way.\rYou can investigate a natural rock sample, trying to figure out the environment which lead to its formation e.g. by applying geothermometers and geobarometers. It is a fascinating field and I should write a blog post about it one day. The downside here is that those methods often come with some significant error-bars.\rThe third method I can think of is to make use of thermodynamic modelling. The advantage clearly is that this approach comes at a fraction of the cost (both money and time) of the other two and is assumed to be considerably more accurate than classical geothermometry and co. A downside is that thermodynamic modeling requires a lot of knowledge about both petrology and the modeling technology of your choice, before you can even start creating anything insightful. Also, most modern petrology-centered modeling tools I know about have rather crude interfaces that can considerably hamper your workflow.\r\rWhatever your line of petrological work is: after obtaining phase stability data, the next big task is to turn that data into a compelling visualization. The classical way to do so is creating a Phase-Diagram. Here is an example of one I did many years ago for my master thesis:\nExperimental phase stability of a nephelinitic melt\n\rSo here we see basically two main features. There is some kind of table-like graphical indicator displaying the phase assemblage for given parameter-combinations. Then there are some annotated lines, stating explicitly when a phase joins or leaves the assemblage. I thought it wouldn’t be so hard to translate these two relatively simple features into code, so that we could have some fun automatizing this otherwise slightly dull task. We will see about that.\n\rPreparing Input Data\rThe above phase-diagram was drawn by hand in a vector graphics program. That’s ok if you only have a couple of small data-sets, but especially when you work with modeling data, it would be better to have an automatic approach that gives you a fast visual feedback of what you are dealing with. That would come with the additional advantage of making your work reproducible and therefore potentially more attractive to collaborators and reviewers. In this blog-post we will explore the possibilities offered in R to generate phase diagrams. For a start, let’s try to recreate my old master thesis’s illustration with code.\n# These are packages needed for data wrangling.\r# Note that their loading order is not arbitrary, # as e.g. the function \u0026#39;select\u0026#39; exists for both the raster and the tidyverse\r# package (via dplyr) and we will need only dplyr::select()\rlibrary(raster)\rlibrary(sf)\rlibrary(smoothr)\rlibrary(tidyverse)\rlibrary(ggspatial)\r# These are packages to style output such as tables and plots\rlibrary(kableExtra)\rlibrary(paletteer)\rlibrary(gridExtra)\rlibrary(grid)\rlibrary(ggpmisc)\r# You can download the phase stability data from my old thesis from github\rdf_exp \u0026lt;- readr::read_csv(\u0026quot;https://raw.githubusercontent.com/Ignimbrit/exchange/master/data/2020/OL_EXP_PHASES.csv\u0026quot;)\rphases_exp \u0026lt;- df_exp %\u0026gt;% dplyr::select(-P_MPa, -T_C) %\u0026gt;% colnames() # Let\u0026#39;s inspect the data!\rkableExtra::kable(df_exp)\r\r\r\rP_MPa\r\rT_C\r\rCombeite\r\rCorundum\r\rMagnetite\r\rMelanite\r\rNepheline\r\rPyroxene\r\r\r\r\r\r300\r\r800\r\rFALSE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r200\r\r800\r\rFALSE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r100\r\r800\r\rFALSE\r\rFALSE\r\rFALSE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r300\r\r750\r\rFALSE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r200\r\r750\r\rFALSE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r100\r\r750\r\rTRUE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r300\r\r700\r\rTRUE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r200\r\r700\r\rTRUE\r\rFALSE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\r\r\r100\r\r700\r\rTRUE\r\rTRUE\r\rTRUE\r\rTRUE\r\rTRUE\r\rFALSE\r\r\r\r300\r\r650\r\rTRUE\r\rTRUE\r\rTRUE\r\rFALSE\r\rFALSE\r\rTRUE\r\r\r\r200\r\r650\r\rTRUE\r\rTRUE\r\rTRUE\r\rTRUE\r\rFALSE\r\rTRUE\r\r\r\r100\r\r650\r\rTRUE\r\rTRUE\r\rTRUE\r\rTRUE\r\rFALSE\r\rTRUE\r\r\r\r\rYou can see that we have to independent variable T_C (Temperature in Celsius) and P_MPa (Pressure in Mega-Pascal) that are combined to form a regular, rectangular grid. Each combination of P and T represents an actual experiment that was performed in a CSPV and later analyzed by microprobe. From the analyses we know which minerals showed up (TRUE) at a given combination of conditions.\n# We sould also take a quick look at some kind of preliminary graph to\r# get a \u0026#39;feeling\u0026#39; for the visual space we will be working with\rdf_exp %\u0026gt;% tidyr::pivot_longer(Combeite:Pyroxene) %\u0026gt;% dplyr::filter(value == TRUE) %\u0026gt;% ggplot(aes(x = T_C, y = P_MPa, color = name)) +\rgeom_jitter(width = 10, height = 10, size = 3)\rSo this is what we will be trying to transform into a phase diagram. The way we will attempt that is essentially to draw some kind of polygons of convex hulls around groups of point clouds as shown above. This is why at the startup of this script we loaded some packages usually associated with spatial data manipulation. Those packages provide us with a comprehensive toolbox for manipulating polygons. That we can leverage spatial algorithms for ggplot2 plots is possible thanks to the ggspatial package written by Dr. Dewey Dunnington who demonstrated the approach in this gist, related to an excellent blog post about hydrogeochemical modelling.\nIn order to bring df_exp in a form that can be plotted as a phase diagram we need to do quite a lot of data wrangling. I realize that this might not be an interesting read for everyone, so I’ve hidden the details of the data transformation in the folded tab below. You can look at it by clicking the red textline. If you are only interested in the actual plotting procedure, you can keep it folded and just move on.\n\r Show me the detailed data treatment procedure!\nAlright, welcome to the machine room of this blog post. Here we will define a set of functions to transform the table shown above into data formats accepted by ggplot2’s geoms. I will be working with functions rather than manipulating the input data directly, so that we can easily apply our workflow to other datasets.\n# First let\u0026#39;s create away to find all existing combinations of phases\r# in the dataset and assign a group-variable to each of them\rphase_group \u0026lt;- function(x, ...){\r# the input of the function is supposed to be a dataframe from which # phase-related coloumns can be selected just like with dplyr::select()\rdf \u0026lt;- x %\u0026gt;% dplyr::select(!!!enquos(...))\rforce(df)\rphase_names \u0026lt;- colnames(df)\r# the next step ist to find the phase assemblage coexisting with each\r# combintation of P \u0026amp; T\rphase_list_lgl \u0026lt;- purrr::pmap(as.list(df), c)\rphase_list_chr \u0026lt;- vector(\u0026quot;list\u0026quot;, length = length(phase_list_lgl))\rfor(i in seq_along(phase_list_chr)){\rphase_list_chr[[i]] \u0026lt;- phase_names[phase_list_lgl[[i]]]\r}\r# now we save the information in a single string (Phase1 + Phase4 + ...)\r# per observation.\rcombinations \u0026lt;- purrr::map_chr(\rphase_list_chr,\r.f = paste,\rcollapse = \u0026quot; + \u0026quot;\r) %\u0026gt;% factor(\rlevels = sort(unique(.))\r)\r# Having a unique string (or rather factor) is nice, but some operations\r# require numbered phase groups\rx %\u0026gt;% mutate(\rphase_combo = combinations\r) %\u0026gt;% mutate(\rgroup_no = as.integer(phase_combo)\r)\r}\r# Now that we can identify the unique phase assemblage for each observation\r# we can make a raster. Think: x = T, y = P, z = assemblage no.\r# This way we can descirbe the area that is occupied by a certain assemblage.\rpolygonize_phasegroup \u0026lt;- function(x, y, z){\r#Note that this function expects a regular grid\rraster::rasterFromXYZ(\rdata.frame(\rx = x,\ry = y,\rz = z\r)\r) %\u0026gt;% # converting to polygons\rraster::rasterToPolygons(dissolve = TRUE) %\u0026gt;% sf::st_as_sf() %\u0026gt;% ggspatial::df_spatial() # converting to ggplot2 polygon notation\r}\r# What we did to identify the area occupied by a certain combination of\r# phases we can now more or less repeat to find the stability field # for a single phase\rfind_phase_border \u0026lt;- function(\rphase_exists, x, y, raster_res = c(NA, NA), size = 1, smooth_factor = 1\r){\rrawdat \u0026lt;- dplyr::bind_cols(x = x, y = y, z = phase_exists)\rdf \u0026lt;- rawdat %\u0026gt;% dplyr::filter(z) %\u0026gt;% dplyr::mutate(z = as.integer(z))\r# Make sure we have a regular grid phase_grid \u0026lt;- expand.grid(x = sort(unique(df$x)), y = unique(sort(df$y))) %\u0026gt;% dplyr::left_join(\rdf,\rby = c(\u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;)\r) %\u0026gt;% as.data.frame()\rphase_grid$z[is.na(phase_grid$z)] \u0026lt;- 0\r# translate to polygon, smoothing the edges a little\rcoord_sf \u0026lt;- raster::rasterFromXYZ(\rphase_grid,\rres = raster_res\r) %\u0026gt;% raster::rasterToPolygons(dissolve = TRUE) %\u0026gt;%\rsf::st_as_sf() %\u0026gt;% dplyr::filter(z == 1) %\u0026gt;% smoothr::smooth(method = \u0026quot;ksmooth\u0026quot;, smoothness = smooth_factor) # resize to avoid overlaps in the plot\rcentroid \u0026lt;- sf::st_centroid(coord_sf)\rsmaller_sf \u0026lt;- (coord_sf - centroid) * size + centroid\r# translate to ggplot2 geom_polygon notation\rsmaller_sf %\u0026gt;%\rsf::st_set_geometry(\u0026quot;geometry\u0026quot;) %\u0026gt;% ggspatial::df_spatial()\r}\r\r(…)\n\rExample 1: Experimental Data set\rSo here we continue equipped with some additional functions we defined in the folded chunk. Now we can draw polygons that will mark the area occupied by a distinct assemblage.\n# Create grouping variable for phase assemblages and assign to every # combination of P \u0026amp; T\rdf_exp_grouped \u0026lt;- phase_group(df_exp, Combeite:Pyroxene)\r# make polygons for unique combinations of minerals\rpolygons_exp \u0026lt;- polygonize_phasegroup(\rx = df_exp_grouped$T_C,\ry = df_exp_grouped$P_MPa,\rz = df_exp_grouped$group_no\r) %\u0026gt;% left_join(\rselect(df_exp_grouped, group_no, phase_combo),\rby = c(\u0026quot;z\u0026quot; = \u0026quot;group_no\u0026quot;)\r)\r# Inspect what we just created\rggplot(\rdata = polygons_exp,\rmapping = aes(\rx = x, y = y, z = z, fill = feature_id\r)\r) +\rgeom_polygon()\rWell, this goes in the right direction but there is still quite some work to do. We can see now the area associated with a distinct assemblage, but the labeling sure can be improved a lot. Second, we should also find a way to communicate clearly, which change in mineral stability leads to the modification of an assemblage (e.g. is magnetite coming in or going out?). Let’s see if we can make the info we’ve got a bit more explicit in the plot. We will start by collecting the phase stability areas of the single minerals.\n# make polygons showing the area of stability for every single phase\r# Note that the function \u0026quot;find_phase_border\u0026quot; was prepared in the folded chunk.\rphase_borders_exp \u0026lt;- purrr::map(\rdplyr::select(df_exp_grouped, Combeite:Pyroxene),\rfind_phase_border,\rx = df_exp_grouped$T_C,\ry = df_exp_grouped$P_MPa,\rraster_res = c(50, 100),\rsize = 1.1\r)\r# gather the polygons associated with the minerals in a single tibble\rborder_df_exp \u0026lt;- purrr::map2_dfr(\rphase_borders_exp,\rnames(phase_borders_exp),\rfunction(.x, .y){mutate(.x, Phase = .y)}\r) \rNext we want to reproduce the table-shaped annotations from the original drawing that give such a nice and quick overview about the composition of the assemblage\n# abbreviate the mineralnames to save space\r# c.f. https://www.unige.ch/sciences/terre/research/Groups/mineral_resources/opaques/ore_abbreviations.php\rabbrv \u0026lt;- c(\u0026quot;cmb\u0026quot;, \u0026quot;crn\u0026quot;, \u0026quot;mgt\u0026quot;, \u0026quot;mel\u0026quot;, \u0026quot;nph\u0026quot;, \u0026quot;cpx\u0026quot;)\r# The table-shaped annotation label of the assemblage should be associated\r# with the assemblage polygons we\u0026#39;ve seen in the last plot\rgeneric_input \u0026lt;- polygons_exp %\u0026gt;% dplyr::group_by(phase_combo) %\u0026gt;% dplyr::summarize(x = mean(x), y = mean(y)) %\u0026gt;% dplyr::mutate(\rphase_list = stringr::str_split(phase_combo, pattern = \u0026quot; \\\\+ \u0026quot;)\r) %\u0026gt;% dplyr::mutate(\rphase_presence = purrr::map(\rphase_list,\rfunction(x, table) {as.integer(match(x, table, nomatch = 0) \u0026gt; 0) + 1},\rx = phases_exp\r)\r)\r# The next part is a bit tricky. There is no standard way of getting the # kind of annotation we want into ggplot2. We have to go one level deeper\r# and construct our own graphical objects (\u0026quot;grob\u0026quot;) using a couple of\r# low level graphical functions from packages {grid} and {gridExtra}\rcatcher_outer \u0026lt;- vector(\u0026quot;list\u0026quot;, length = nrow(generic_input))\rfor(i in seq_along(catcher_outer)){\rcatcher_inner \u0026lt;- vector(\u0026quot;list\u0026quot;, length = length(abbrv))\rfor (j in seq_along(abbrv)) {\rcatcher_inner[[j]] \u0026lt;- grid::grobTree(\rgrid::rectGrob(\rgp = grid::gpar(\rfill = c(\u0026quot;black\u0026quot;, \u0026quot;white\u0026quot;)[generic_input$phase_presence[[i]][j]], lwd = 2\r)\r), grid::textGrob(abbrv[j], gp = grid::gpar(fontsize = 10))\r)\r}\rcatcher_outer[[i]] \u0026lt;- gridExtra::arrangeGrob(grobs = catcher_inner, ncol = 3)\r}\r# Collect the objects we just build along with some metadata in a tibble\rgrob_df \u0026lt;- generic_input %\u0026gt;% dplyr::mutate(\rgrob = catcher_outer,\rwidth = 0.17,\rheight = 0.17\r)\rFinally we now should have all the information/data we need for a pleasant plot.\nggplot() +\rgeom_polygon( # phase assemblage polygons\rdata = polygons_exp,\rmapping = aes(\rx = x, y = y, fill = feature_id, group = piece_id\r),\rcolor = \u0026quot;black\u0026quot;,\rshow.legend = FALSE,\ralpha = 0.25\r) +\rgeom_polygon( # single mineral phase polygons\rdata = border_df_exp,\raes(\rx = x, y = y, color = Phase\r),\rfill = NA,\rsize = 1.25\r) +\rggpmisc::geom_grob( # custom annotation grobs\rdata = grob_df,\raes(\rx = x, y = y, label = grob, vp.width = width, vp.height = height\r)\r) +\rcoord_cartesian(xlim = c(625, 825), ylim = c(50, 350), expand = FALSE) +\rpaletteer::scale_fill_paletteer_d(\u0026quot;nord::algoma_forest\u0026quot;) +\rpaletteer::scale_colour_paletteer_d(\u0026quot;yarrr::appletv\u0026quot;, direction = 1) +\rlabs(\ry = \u0026quot;Pressure [MPa]\u0026quot;, x = \u0026quot;Temperature [°C]\u0026quot;,\rtitle = \u0026quot;Experimental Phase Stability of Nephelinitic Melt\u0026quot;\r) +\rtheme_bw()\rSo that’s the final plot. There are still a few differences to the original. On the one hand, custom text annotations for lines are hard to automatize, on the other hand, drawing your phase diagram automatically from data makes it easier to use colors. One could opt to use different linetypes for the mineral stability borders, but personally I found the color coding to be more clear. The plot could also use some manual fine tuning on the edges, but fortunately it’s very easy to export ggplot2 objects to svg, so one could continue in e.g. Inkscape.\n\rExample 2: Thermodynamic Model (MELTS) Data set\rMELTS is “a software package designed to facilitate thermodynamic modeling of phase equilibria in magmatic systems. It provides the ability to compute equilibrium phase relations for igneous systems over the temperature range 500-2000 °C and the pressure range 0-2 GPa.”\nOver the last years, MELTS has (to my knowledge) become one of the most popular thermodynamic modeling suites for petrology-related research. The advantages of modelling over experimental approaches we have already discussed. Now we will look at a modeled data set with a much much finer temperature resolution than ever would be possible to accomplish in a lab.\n# You can download the data we will use from GitHub:\rdf_MELTS \u0026lt;- read_csv(\u0026quot;https://raw.githubusercontent.com/Ignimbrit/exchange/master/data/2020/MELTS_DAWN_simplified.csv\u0026quot;)\rphases_MELTS \u0026lt;- df_MELTS %\u0026gt;% dplyr::select(-P_MPa, -T_C) %\u0026gt;% colnames() df_MELTS\r## # A tibble: 266 x 8\r## T_C P_MPa biotite clinopyroxene feldspar olivine orthopyroxene spinel\r## \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;lgl\u0026gt; \u0026lt;lgl\u0026gt; \u0026lt;lgl\u0026gt; \u0026lt;lgl\u0026gt; \u0026lt;lgl\u0026gt; \u0026lt;lgl\u0026gt; ## 1 1222. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 2 1217. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 3 1212. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 4 1207. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 5 1202. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 6 1197. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 7 1192. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 8 1187. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 9 1182. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## 10 1177. 100 FALSE FALSE FALSE TRUE FALSE FALSE ## # ... with 256 more rows\rThis modelling data was kindly provided by Dr. Dawn Ruth who, by the way, also gave me the initial impulse to look into phase diagram creation in R. I have slightly simplified the MELTS output to make the table fit the needs for this demonstration. As you can see, we are again provided with two independent variables T_C and P_MPa and a set of six dependent variable columns, indicating the presence of various mineral phases for a given P-T. Unlike with the experimental data set, however, this time we have 266 observations (=rows in the table) instead of just 12. Again we start with a quick visualization of the shape of data we got here.\ndf_MELTS %\u0026gt;% tidyr::pivot_longer(biotite:spinel) %\u0026gt;% dplyr::filter(value == TRUE) %\u0026gt;% ggplot(aes(x = T_C, y = P_MPa, color = name)) +\rgeom_jitter(width = 0, height = 10)\rNote that unlike in the experimental data set, the data in df_MELTS is irregularly spaced. There are observations for 0.5, 1, 2 and 5 kbar (but not for e.g. 1.5 or 3 kbar). Also there are observations at higher temperatures, the higher the pressure in the simulation was. Because of the way we have build our tools for creating phase diagrams, we will first have to rectify those “holes” in the data.\n# First we get rid of decimal places. We do not need to be that precise for the\r# diagram and they make creating a regular grid unecessary difficult.\rdf_MELTS_simple \u0026lt;- df_MELTS %\u0026gt;% dplyr::mutate(\rT_C = as.integer(round(T_C)),\rP_MPa = as.integer(P_MPa)\r)\r# The regular grid shall have a T-resolution of 1°C and a P-resolution of\r# 50 MPa, which (more or less) corresponds to the steps modeled in MELTS\r# in this case.\rrange_MELTS_T \u0026lt;- seq(\rmin(df_MELTS_simple$T_C), max(df_MELTS_simple$T_C), 1\r)\rrange_MELTS_P \u0026lt;- seq(\rmin(df_MELTS_simple$P_MPa), max(df_MELTS_simple$P_MPa), 50\r)\r# Next we fill in the holes in our regular grid.\r# We do so by \u0026quot;wandering down\u0026quot; the pressure (later the temperature) sequence\r# and whenever we encounter missing information about the presence of mineral\r# phases, we assume nothing has changed since the last time we saw them.\r# This is not so much different from what you would do when drawing a phase-\r# diagram by hand. That workflow was inspired by a vignette of the tsibble\r# package originally adressing missing values in time-series data\r# https://tsibble.tidyverts.org/articles/implicit-na.html\rgrd_MELTS \u0026lt;- as.data.frame(expand.grid(range_MELTS_T, range_MELTS_P)) %\u0026gt;% dplyr::rename(T_C = Var1, P_MPa = Var2) %\u0026gt;% dplyr::arrange(dplyr::desc(P_MPa), dplyr::desc(T_C)) %\u0026gt;% dplyr::left_join(df_MELTS_simple, by = c(\u0026quot;T_C\u0026quot;, \u0026quot;P_MPa\u0026quot;)) %\u0026gt;% dplyr::group_split(P_MPa) %\u0026gt;% purrr::map_dfr(\r.f = tidyr::fill, biotite:spinel, .direction = \u0026quot;down\u0026quot;\r) %\u0026gt;% dplyr::group_split(T_C) %\u0026gt;% purrr::map_dfr(\r.f = tidyr::fill, biotite:spinel, .direction = \u0026quot;down\u0026quot;\r)%\u0026gt;% dplyr::group_split(T_C) %\u0026gt;% purrr::map_dfr(\r.f = tidyr::fill, biotite:spinel, .direction = \u0026quot;up\u0026quot;\r)\rgrd_MELTS %\u0026gt;% tidyr::pivot_longer(biotite:spinel) %\u0026gt;% dplyr::filter(value == TRUE) %\u0026gt;% ggplot(aes(x = T_C, y = P_MPa, color = name)) +\rgeom_jitter(width = 0, height = 10)\rAs you can see, the data is now both rectangular and regular and we can apply our established workflow of creating a raster and subsequently polygonizing it.\n# Identify unique mineral assemblages\rdf_MELTS_grouped \u0026lt;- phase_group(grd_MELTS, biotite:spinel)\r# Create assemblage polygons\rpolygons_MELTS \u0026lt;- polygonize_phasegroup(\rx = df_MELTS_grouped$T_C,\ry = df_MELTS_grouped$P_MPa,\rz = df_MELTS_grouped$group_no\r)%\u0026gt;% left_join(\rselect(df_MELTS_grouped, group_no, phase_combo),\rby = c(\u0026quot;z\u0026quot; = \u0026quot;group_no\u0026quot;)\r)\r# create single phase stability polygons\rphase_borders_MELTS \u0026lt;- purrr::map(\rdplyr::select(df_MELTS_grouped, biotite:spinel),\rfind_phase_border,\rx = df_MELTS_grouped$T_C,\ry = df_MELTS_grouped$P_MPa,\rraster_res = c(1, 50),\rsize = 1.02,\rsmooth_factor = 4\r) %\u0026gt;% purrr::map2(\r.x = .,\r.y = seq(1, length(.)),\rfunction(.x, .y) {\rmutate(\r.x, piece_id = factor(\ras.double(\ras.character(\rpiece_id\r)\r) + .y\r)\r)\r}\r)\r# gather the polygons associated with the minerals in a single tibble\rborder_df_MELTS \u0026lt;- purrr::map2_dfr(\rphase_borders_MELTS,\rnames(phase_borders_MELTS),\rfunction(.x, .y){mutate(.x, Phase = .y)}\r) \r# Create table-like assemblage markers as inset plots\r# I will abbreviate the mineralnames to save space\r# c.f. https://www.unige.ch/sciences/terre/research/Groups/mineral_resources/opaques/ore_abbreviations.php\rabbrv_MELTS \u0026lt;- c(\u0026quot;bt\u0026quot;, \u0026quot;cx\u0026quot;, \u0026quot;fs\u0026quot;, \u0026quot;ol\u0026quot;, \u0026quot;ox\u0026quot;, \u0026quot;sp\u0026quot;)\r# The table-shaped annotation label of the assemblage should be associated\r# with the assemblage polygons we\u0026#39;ve seen in the last plot\rgeneric_input_MELTS \u0026lt;- polygons_MELTS %\u0026gt;% dplyr::group_by(phase_combo) %\u0026gt;% dplyr::summarize(\rx = mean(x), y = mean(y)\r) %\u0026gt;% dplyr::mutate(\rphase_list = stringr::str_split(phase_combo, pattern = \u0026quot; \\\\+ \u0026quot;)\r) %\u0026gt;% dplyr::mutate(\rphase_presence = purrr::map(\rphase_list,\rfunction(x, table) {as.integer(match(x, table, nomatch = 0) \u0026gt; 0) + 1},\rx = phases_MELTS\r)\r)\r# Build the grobs\rcatcher_outer \u0026lt;- vector(\u0026quot;list\u0026quot;, length = nrow(generic_input_MELTS))\rfor(i in seq_along(catcher_outer)){\rcatcher_inner \u0026lt;- vector(\u0026quot;list\u0026quot;, length = length(abbrv_MELTS))\rfor (j in seq_along(catcher_inner)) {\rcatcher_inner[[j]] \u0026lt;- grid::grobTree(\rgrid::rectGrob(\rgp = grid::gpar(\rfill = c(\u0026quot;black\u0026quot;, \u0026quot;white\u0026quot;)[generic_input_MELTS$phase_presence[[i]][j]], lwd = 1.2\r)\r), grid::textGrob(abbrv_MELTS[j], gp = grid::gpar(fontsize = 7.5))\r)\r}\rcatcher_outer[[i]] \u0026lt;- gridExtra::arrangeGrob(grobs = catcher_inner, ncol = 3)\r}\r# Collect the objects we just build along with some metadata in a tibble\rgrob_df_MELTS \u0026lt;- generic_input_MELTS %\u0026gt;% dplyr::mutate(\rgrob = catcher_outer,\rwidth = 0.08,\rheight = 0.08\r)\rAs the modeled data set is substantially larger than the experimental one we’ve been examining above, we will have to make some visual adjustments to our final phase diagram plot.\nCreating the annotation labels for the MELTS data is somewhat more difficult than for the experimental data. With the experimental data, we positioned those table-shaped annotations centrally within the polygon of the associated assemblage. This works (sometimes) for smaller plots with a limited number of different assemblages, but if we’d use that approach to annotate the MELTS-data phase diagram, the grobs would overlap, rendering them unreadable.\nTo automatically avoid this issue, we would need some kind of repel-algorithm similar to the functionality provided by the ggrepel package. Unfortunately, ggrepel applies to text annotations only with no simple way to use it for custom grobs. Developing our own repel algorithm on the other hand is way beyond the scope of this blog article, that by now has already escalated significantly beyond what I had initially envisioned for today’s issue.\nTo avoid this problem for now I went with an admittedly dodgy fix of making the annotation grobs smaller and adding the position = position_jitter() argument to ggpmisc::geom_grob. If this was a plot meant for publication e.g. in a journal, one would probably have to invest the time to adjust each annotation position manually and maybe also set up an additional legend. For now we shall proceed as follows:\nggplot() +\rgeom_polygon(\rdata = polygons_MELTS,\rmapping = aes(\rx = x, y = y, fill = feature_id, group = piece_id\r),\rcolor = \u0026quot;black\u0026quot;,\rshow.legend = FALSE,\ralpha = 0.3\r) +\rgeom_polygon(\rdata = border_df_MELTS,\raes(\rx = x, y = y, color = Phase, group = piece_id\r),\rfill = NA,\rsize = 1.25\r) +\rggpmisc::geom_grob(\rdata = grob_df_MELTS,\raes(\rx = x, y = y, label = grob, vp.width = width, vp.height = height\r),\rposition = position_jitter(width = 15, height = 15, seed = 42)\r) +\rcoord_cartesian(xlim = c(900, 1250), ylim = c(25, 525), expand = FALSE) +\rpaletteer::scale_fill_paletteer_d(\u0026quot;ggsci::default_igv\u0026quot;, direction = 1) +\rpaletteer::scale_colour_paletteer_d(\u0026quot;yarrr::appletv\u0026quot;, direction = 1) +\rlabs(\ry = \u0026quot;Pressure [MPa]\u0026quot;, x = \u0026quot;Temperature [°C]\u0026quot;,\rtitle = \u0026quot;Phase Stability of a Magma Modeled with MELTS\u0026quot;\r) +\rtheme_bw()\r\rConcluding Remarks\rCreating a workflow to plot mineral phase stability diagrams directly from data and with a minimum of manual alteration has proven to be quite a laborious task in itself. If you are looking for something similar, I hope I could provide you here with some inspiration on how to tackle some of the more arcane problems of confining areas of shared properties within a cartesian grid system. Now that the tools presented in this blog post exist, I can definitely see myself applying them in the future in quite a range of situations, not all of them necessarily related to petrology. As the whole workflow is based around the ideas of grouped polygons, much of it should work for certain spatial issues, too.\n\r","date":1587427200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1587938918,"objectID":"1dc77721a1057115a85b196b5739c398","permalink":"/post/phase_diagrams/","publishdate":"2020-04-21T00:00:00Z","relpermalink":"/post/phase_diagrams/","section":"post","summary":"Preface\rPreparing Input Data\rExample 1: Experimental Data set\rExample 2: Thermodynamic Model (MELTS) Data set\rConcluding Remarks\r\r\rPreface\rIn petrology it is common to be confronted with or thinking about mineral phase stability.","tags":[],"title":"Constructing Mineral Phase Diagrams in R","type":"post"},{"authors":[],"categories":[],"content":"\rMineral point counting in geological thin sections is a simple yet very useful technique that aims at determining the relative proportion of different minerals within a rock. Quantifying this can give insight on the evolution of a magma within different stages of melt evolution or even underpin comparisons of similar melts from different magmatic complexes. Point counting in it’s classical form is, however, also famously laborious, as it traditionally involves manually shifting the microscopes stage by a fixed interval and basically keeping a tally of what you see at each position.\nWith the advent of computerized image processing techniques, digital point counting offers the potential to gather the desired information at a fraction of the time and effort used for the manual technique. This makes it possible to apply point counting to large databases of thin section imagery. I would argue that being able to massively broaden the base of available point counting data by (semi-)automating the gathering process is in itself a significant contribution to the importance of the role that point counting can play in geological investigations.\nIn this blogpost we will explore possibilities for digital point counting using R and the mincountr library, a little package I wrote to bundle a few basic tools to ease some of the more repetitive tasks of that subject.\n# You can install the mincountr package from github\r# remotes::install_github(\u0026quot;Ignimbrit/mincountr\u0026quot;)\rlibrary(mincountr)\rlibrary(ggplot2)\rSay you have collected an image from a mineral-bearing thin section e.g. in an electron microprobe session and wonder about the relative share of the different phases in your sample. Your image might look something like this:\nmyimage \u0026lt;- mcr_load_image(\rsystem.file(\u0026quot;extdata\u0026quot;, \u0026quot;testim.png\u0026quot;, package = \u0026quot;mincountr\u0026quot;)\r)\rplot(myimage)\rAs you can see, the different levels of brightness in the image allows the observer to distinguish between several distinct phases. There is a large, very bright mineral, some lightgrey minerals, a darkgrey, glassy matrix, some black holes and so on. With mincountr we are able to translate this qualitative optical assessment into practical numbers. First let’s have a look at the density-distribution (like a continuous histogram) of the images brightness.\nmcr_inspect_phases(myimage)\rHere we can see that the four phases we distinguished in the image above show up in the density distribution as distinct peaks of specific brightness values. We can use this to assign a brightness-range to certain phases.\rThe peak on the far left (most dark) corresponds likely to the hole we’ve seen in our thin section image. The peak’s value range lays between value ~0-0.05. Other peaks (from left to right) range from 0.3-0.45 (glassy matrix?), from 0.5-0.65 (light gray minerals?) and from 0.92-1 (bright minerals?). Let me illustrate what I mean:\nmcr_inspect_phases(myimage) +\rggplot2::geom_vline(\rxintercept = c(0, 0.05, 0.3, 0.45, 0.5, 0.65, 0.92, 1),\rcolor = \u0026quot;red\u0026quot;\r)\rNow in this example we just chose the borders of the peak by hand. This is probably the safest method of constraining your brightness-levels, as it allows you to chip in your personal mineralogical expertise. However, sometimes you have a large stack of images you want to work with and probably not the time to constrain peak-ranges by hand every single time. This is why mincountr comes with an automatic mechanism to generate those numbers for you.\nmyconstrains \u0026lt;- mcr_autoconstrain(myimage)\rprint(myconstrains)\r## # A tibble: 4 x 4\r## x1 peakpos x2 ID\r## \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt;\r## 1 0 0 0.0283 1\r## 2 0.338 0.382 0.437 2\r## 3 0.501 0.559 0.612 3\r## 4 0.963 0.989 1 4\rThe mcr_autoconstrain function automatically detects peaks and notes their position (peakpos) and then goes on and calculates their borders both on the left-hand-side (x1) and on the right hand side (x2). Under the hood, mcr_autoconstrain identifies turning points in the brightness-“spectra”, cuts it into pieces, one piece per peak, and then loops over the single-peak spectra-pieces to calculate the half-height-width.\nNow we have all the information we need to assign certain areas of our original image to distinct phases. The mincountr-package comes with a function that lets you inspect what this assignment looks like.\nmcr_inspect_assignment(\rmyimage,\rlhs = myconstrains$x1,\rrhs = myconstrains$x2\r)\rAs every pixel in the original image was now assigned to one of the 7 levels shown in the picture above, we can go ahead and just count the pixels and then calculate the relative share of each group.\nmyresult \u0026lt;- mcr_herd_minerals(\rmyimage,\rlhs = myconstrains$x1,\rrhs = myconstrains$x2\r)\rprint(myresult)\r## # A tibble: 7 x 3\r## Phase_ID pixels proportion_percentage\r## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 1 34862 9.88\r## 2 2 23583 6.68\r## 3 3 97086 27.5 ## 4 4 18786 5.32\r## 5 5 70327 19.9 ## 6 6 23485 6.66\r## 7 7 84749 24.0\r","date":1586476800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1586528131,"objectID":"9ca3389f7b4b5c5e57af4e62c5507428","permalink":"/post/digital_point_counting/","publishdate":"2020-04-10T00:00:00Z","relpermalink":"/post/digital_point_counting/","section":"post","summary":"Mineral point counting in geological thin sections is a simple yet very useful technique that aims at determining the relative proportion of different minerals within a rock. Quantifying this can give insight on the evolution of a magma within different stages of melt evolution or even underpin comparisons of similar melts from different magmatic complexes.","tags":[],"title":"Digital Point Counting for Mineralogical Thin Sections","type":"post"},{"authors":[],"categories":[],"content":"\rMany tasks in the realm of Hydrogeology require data from meteorological observations to be taken into account. If you are working on such a project that happens to be located in Germany, you can count yourself lucky, because the Deutscher Wetterdienst (DWD, German Meteorological Service) is providing a cornucopia of both brand new and historic data for free via its climate datacenter (CDC). The interface to that server, however, can be somewhat confusing at first, due to the mass of very different data formats and the poignant absence of any meaningful GUI. In this post we will therefore explore how we can use R and specifically the rdwd library to access data from the CDC and turn it into a (hopefully) meaningful visualization.\nFor demonstration purposes, let’s look at how the number of days with snowcover changed in Germany over the years, a task I came up with this winter, while looking out of the window and, well, missing snow. As mentioned, we will use R-package rdwd, which ships with an excellent documentation that we can use to look up how to find the data we are interested in, download it and load it into R.\nBy and at large, DWD-datasets can be divided into two categories:\nData associated with a discrete weather station\rGridded data spanning a larger area (usually all of Germany)\r\rAs we are interested in snow cover data for all of Germany, we will look into the gridded data.\n# first let\u0026#39;s get our R-session set up properly\rlibrary(tidyverse) # this is for data-wrangling and -visualisation library(rdwd) # this is where we get our data from\rlibrary(raster) # this will help us work with raster data\rlibrary(sp) # this is used here to convert between spatial data formats\rlibrary(paletteer) # pretty color palettes for plots\rlibrary(magick) # his will be used to render the final animation\r# The next step is to locate the data we are interested in on the CDC-Server\r# Load the adresses of all available files data(gridIndex)\r# only keep the adresses of data we are interested in\rlinks \u0026lt;- gridIndex[str_detect(gridIndex, \u0026quot;^annual/snowcover_days/grids\u0026quot;)]\rhead(links, n = 3) #inspect what we\u0026#39;ve got\r## [1] \u0026quot;annual/snowcover_days/grids_germany_annual_snowcover_days_1951_17.asc.gz\u0026quot;\r## [2] \u0026quot;annual/snowcover_days/grids_germany_annual_snowcover_days_1952_17.asc.gz\u0026quot;\r## [3] \u0026quot;annual/snowcover_days/grids_germany_annual_snowcover_days_1953_17.asc.gz\u0026quot;\rtail(links, n = 3)\r## [1] \u0026quot;annual/snowcover_days/grids_germany_annual_snowcover_days_2016_17.asc.gz\u0026quot;\r## [2] \u0026quot;annual/snowcover_days/grids_germany_annual_snowcover_days_2017_17.asc.gz\u0026quot;\r## [3] \u0026quot;annual/snowcover_days/grids_germany_annual_snowcover_days_2018_17.asc.gz\u0026quot;\rSo we managed to locate the position of 68 files of gridded snow-cover data. Each file contains the data for a single year and we have files spanning the period from 1951 to 2018. Now that we know where we can find the data, the next steps are:\n\rDownloading the data to your hard disc\rActually loading the data into R\rShaping the data into a format to work on with\r\rThis is achieved mainly by two functions provided by rdwd. We will download the data with dataDWD and load it with readDWD. Please note that the downloaded files are stored on your hard drive and take up approximately 200 MB of space. As we need to download all 68 files, we will iterate over every element of links, applying the function-in-question on the way.\nmap(\rlinks, dataDWD, base = gridbase, joinbf = TRUE, read = FALSE\r)\r# Executed like this, the downloaded files will be stored in a subdirectory\r# named \u0026quot;DWDdata/\u0026quot;. Let\u0026#39;s see what we\u0026#39;ve got!\rlokallinks \u0026lt;- list.files(\u0026quot;DWDdata/\u0026quot;)\r# In the next step we will do something a bit more complex.\r# The goal is to load the downloaded files into R and give them a structure\r# that is convenient to work with. As we want this to happen with all 68\r# files, we will define a function that loads a file and returns the data # in the desired way and then apply said function to every file.\rgrabmydata \u0026lt;- function(file){\r# first let\u0026#39;s load the data and store it in a nice data.frame\rdf \u0026lt;- readDWD(paste0(\u0026quot;DWDdata/\u0026quot;, file)) %\u0026gt;% as(\u0026quot;SpatialPixelsDataFrame\u0026quot;) %\u0026gt;% as.data.frame()\r# give it some nice coloumn names\rcolnames(df) \u0026lt;- c(\u0026quot;value\u0026quot;, \u0026quot;x\u0026quot;, \u0026quot;y\u0026quot;)\r# next we want to know the year that the data corresponds to\ryear \u0026lt;- file %\u0026gt;% str_remove(\u0026quot;annual_snowcover_days_grids_germany_annual_snowcover_days_\u0026quot;) %\u0026gt;% str_remove(\u0026quot;_17.asc.gz\u0026quot;) %\u0026gt;% as.integer()\r# Now just store the year as another variable in the data.frame\rdf %\u0026gt;% mutate(year = year)\r}\r# Now that we have a function that knows how to handle a file, iterate over\r# all files and append the result rowwise.\rdf \u0026lt;- map_dfr(lokallinks, grabmydata)\rNow that we have all the data nicely loaded into our global environment, we can start visualizing them. In a first step, let’s look at the situation in the year 2008. We can later expand this to include all years.\nThere is one little catch, though. To make the figure more visually appealing, we will apply a logarithmic color gradient, while keeping the actual scale linear.\ndf_08 \u0026lt;- df %\u0026gt;% filter(year == 2008)\r# In the plot legend we want to see what the color looks like for the following # numbers of days of snow cover:\rsnow_days_legend \u0026lt;- c(0.1, 0.3, 1, 3, 10, 30)\rggplot(\rdata = df_08,\raes(\rx = x,\ry = y,\rfill = log10(value)\r)\r) +\rgeom_tile() +\rannotate(\rgeom = \u0026quot;label\u0026quot;, x = max(df$x) - 140000, y = min(df$y) - 10000,\rlabel = \u0026quot;source: Deutscher Wetterdienst\u0026quot;,\rsize = 2\r) +\rlabs(\rtitle = \u0026quot;Total days of snow in 2008\u0026quot;,\rfill = \u0026quot;days with\\nsnow-cover\u0026quot;\r) +\rscale_fill_paletteer_c(\r\u0026quot;ggthemes::Classic Orange-Blue\u0026quot;,\rlimits = log10(c(0.1, 60)),\rbreaks = log10(snow_days_legend),\rlabels = snow_days_legend\r) +\rtheme_bw() +\rtheme(\raxis.title = element_blank(),\raxis.text = element_blank(),\r)\rNow this is nice, but it only shows us the situation for a single year, which tells us nothing about how the snow-cover-situation changed over time. Question is: how do we include the plots for the other years? One might be tempted to work with facets here, but faceting 68 plots will result in a visual overload. The better solution is to build a little gif.\ndf_list \u0026lt;- df %\u0026gt;% group_split(year)\r# Make a time-series vector for iteration\rts \u0026lt;- map_dbl(df_list, function(x) {first(x$year)})\r# here we iterate along the years, plotting each annual dataset and subsequently\r# saving the resulting image to the hard disc. This might take a while. The\r# produced data has a size of ~7Mb\r# ATTENTION: note that I am saving the plots in a subdirectory called \u0026quot;facets\u0026quot;.\r# ggsave will not create that subdir automatically, so you may have to set it up\r# manually. I decided not to create it in this code chunk as that would equal\r# messing up other peoples folder-system, which I was told is bad style.\rfor (i in seq_along(ts)){\rgif_facet \u0026lt;- ggplot(\rdata = df_list[[i]],\raes(\rx = x,\ry = y,\rfill = log10(value)\r)\r) +\rgeom_tile() +\rannotate(\rgeom = \u0026quot;label\u0026quot;, x = max(df$x) - 140000, y = min(df$y) - 10000,\rlabel = \u0026quot;source: Deutscher Wetterdienst\u0026quot;,\rsize = 2\r) +\rlabs(\rtitle = paste0(\u0026quot;Total days of snow in \u0026quot;, ts[i]),\rfill = \u0026quot;days with\\nsnow-cover\u0026quot;\r) +\rscale_fill_paletteer_c(\r\u0026quot;ggthemes::Classic Orange-Blue\u0026quot;,\rlimits = log10(c(0.1, 60)),\rbreaks = log10(snow_days_legend),\rlabels = snow_days_legend\r) +\rtheme_bw() +\rtheme(\raxis.title = element_blank(),\raxis.text = element_blank(),\r)\rggsave(\rfilename = paste0(\u0026quot;facets/snow_\u0026quot;, ts[i],\u0026quot;.png\u0026quot;), # make sure this works on your machine!\rplot = gif_facet,\rwidth = 10, height = 12, units = \u0026quot;cm\u0026quot;, dpi = 150\r)\r}\r# get the path of the created images\rplotlist \u0026lt;- list.files(\u0026quot;facets/\u0026quot;, pattern = \u0026quot;.png$\u0026quot;)\r# construct the actual gif\rimage_write_gif(\rimage_read(paste0(\u0026quot;facets/\u0026quot;, plotlist)),\rpath = \u0026quot;Snowdays_in_Ger.gif\u0026quot;,\rdelay = 0.5\r)\r","date":1586304000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1586337146,"objectID":"0f3a8041685d0f8a6328b3a828f1f755","permalink":"/post/working-with-rdwd/","publishdate":"2020-04-08T00:00:00Z","relpermalink":"/post/working-with-rdwd/","section":"post","summary":"Many tasks in the realm of Hydrogeology require data from meteorological observations to be taken into account. If you are working on such a project that happens to be located in Germany, you can count yourself lucky, because the Deutscher Wetterdienst (DWD, German Meteorological Service) is providing a cornucopia of both brand new and historic data for free via its climate datacenter (CDC).","tags":[],"title":"Working with climate data from the German Meteorological Service (DWD)","type":"post"},{"authors":[],"categories":[],"content":"Angaben gemäß § 5 TMG Dr. rer. nat. Sören Wilke\nAchillesstraße 94\n13125 Berlin\nKontakt Telefon: +49 (0) 151 6453 2291\nE-Mail: swilke@gmx.de\nHaftung für Inhalte Als Diensteanbieter sind wir gemäß § 7 Abs.1 TMG für eigene Inhalte auf diesen Seiten nach den allgemeinen Gesetzen verantwortlich. Nach §§ 8 bis 10 TMG sind wir als Diensteanbieter jedoch nicht verpflichtet, übermittelte oder gespeicherte fremde Informationen zu überwachen oder nach Umständen zu forschen, die auf eine rechtswidrige Tätigkeit hinweisen. Verpflichtungen zur Entfernung oder Sperrung der Nutzung von Informationen nach den allgemeinen Gesetzen bleiben hiervon unberührt. Eine diesbezügliche Haftung ist jedoch erst ab dem Zeitpunkt der Kenntnis einer konkreten Rechtsverletzung möglich. Bei Bekanntwerden von entsprechenden Rechtsverletzungen werden wir diese Inhalte umgehend entfernen.\nHaftung für Links Unser Angebot enthält Links zu externen Websites Dritter, auf deren Inhalte wir keinen Einfluss haben. Deshalb können wir für diese fremden Inhalte auch keine Gewähr übernehmen. Für die Inhalte der verlinkten Seiten ist stets der jeweilige Anbieter oder Betreiber der Seiten verantwortlich. Die verlinkten Seiten wurden zum Zeitpunkt der Verlinkung auf mögliche Rechtsverstöße überprüft. Rechtswidrige Inhalte waren zum Zeitpunkt der Verlinkung nicht erkennbar. Eine permanente inhaltliche Kontrolle der verlinkten Seiten ist jedoch ohne konkrete Anhaltspunkte einer Rechtsverletzung nicht zumutbar. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige Links umgehend entfernen.\nUrheberrecht Die durch die Seitenbetreiber erstellten Inhalte und Werke auf diesen Seiten unterliegen dem deutschen Urheberrecht. Die Vervielfältigung, Bearbeitung, Verbreitung und jede Art der Verwertung außerhalb der Grenzen des Urheberrechtes bedürfen der schriftlichen Zustimmung des jeweiligen Autors bzw. Erstellers. Downloads und Kopien dieser Seite sind nur für den privaten, nicht kommerziellen Gebrauch gestattet. Soweit die Inhalte auf dieser Seite nicht vom Betreiber erstellt wurden, werden die Urheberrechte Dritter beachtet. Insbesondere werden Inhalte Dritter als solche gekennzeichnet. Sollten Sie trotzdem auf eine Urheberrechtsverletzung aufmerksam werden, bitten wir um einen entsprechenden Hinweis. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige Inhalte umgehend entfernen.\nQuelle: eRecht24\n","date":1586104083,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1586104083,"objectID":"c0d697420e62c6110836b47cfe5ae9b2","permalink":"/impressum/","publishdate":"2020-04-05T18:28:03+02:00","relpermalink":"/impressum/","section":"","summary":"Angaben gemäß § 5 TMG Dr. rer. nat. Sören Wilke\nAchillesstraße 94\n13125 Berlin\nKontakt Telefon: +49 (0) 151 6453 2291\nE-Mail: swilke@gmx.de\nHaftung für Inhalte Als Diensteanbieter sind wir gemäß § 7 Abs.","tags":[],"title":"Impressum","type":"page"},{"authors":[],"categories":[],"content":"","date":1586094717,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1586094717,"objectID":"c5a0c2312834bfc6cc602e78c776e73b","permalink":"/publication/","publishdate":"2020-04-05T15:51:57+02:00","relpermalink":"/publication/","section":"","summary":"","tags":[],"title":"Publication","type":"page"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Academic  Academic | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click  PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions?  Ask\n Documentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Academic's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":["Sören Wilke","Francois Holtz","Xiaoyan Li","David A. Neave","Renat Almeev"],"categories":null,"content":"","date":1548979200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1548979200,"objectID":"c77585a001a48954d28f2d3726bc8d05","permalink":"/publication/derp2/","publishdate":"2019-02-01T00:00:00Z","relpermalink":"/publication/derp2/","section":"publication","summary":"Gualda et al. (2018) applied rhyolite-MELTS and DERP to several case studies and noted that DERP has a lower precision and yields distributions of estimated pressures that are significantly different from other geobarometers based on the H2O–CO2 of glass inclusions and amphibole geobarometry. In an attempt to clarify the discrepancy between rhyolite-MELT and DERP, Gualda et al. (2018) describe several problems with DERP. In the following sections we address the critical points mentioned in the comment of Gualda et al. (2018).","tags":["Source Themes"],"title":"Rhyolite-MELTS vs DERP – Reply to Comment by Gualda et al. on ‘The Effect of Anorthite Content and Water on Quartz–Feldspar Cotectic Compositions in the Rhyolitic System and Implications for Geobarometry’ by Wilke et al. (2017), Journal of Petrology, 58, No. 4, 789–818","type":"publication"},{"authors":["Sören Wilke","Francois Holtz","David A. Neave","Renat Almeev"],"categories":null,"content":"","date":1500854400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1500854400,"objectID":"6124e5c4473923d88445feca013064c2","permalink":"/publication/derp1/","publishdate":"2017-07-24T00:00:00Z","relpermalink":"/publication/derp1/","section":"publication","summary":"The position of the cotectic curve separating quartz and feldspar stability fields in the rhyolite system Qz–Ab–Or(–An–H2O) depends on pressure, making it a potential geobarometer applicable to high-silica volcanic products if melt water contents (H2Omelt) are known.","tags":["Source Themes"],"title":"The Effect of Anorthite Content and Water on Quartz–Feldspar Cotectic Compositions in the Rhyolitic System and Implications for Geobarometry","type":"publication"},{"authors":["Sören Wilke"],"categories":null,"content":"","date":1466726400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1466726400,"objectID":"9e63a5aa6b6ad94a5cb670e37e26ebed","permalink":"/publication/promotion/","publishdate":"2016-06-24T00:00:00Z","relpermalink":"/publication/promotion/","section":"publication","summary":"Developement of a geobarometer based on the experimental investigation of phase stabilities of various tectosilicates and application to thyolites of the Yellowstone Snake River Plain.","tags":["Source Themes"],"title":"The system quartz-albite-orthoclase-anorthite-H2O as a geobarometer: experimental calibration and application to rhyolites of the Snake River Plain, Yellowstone, USA","type":"publication"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":["Chao Zhang","Jürgen Koepke","Lian-Xun Wang","Paul E. Wolff","Sören Wilke","André Stechern","Renat Almeev","Francois Holtz"],"categories":null,"content":"","date":1450828800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1450828800,"objectID":"35b69c7585fe94f7df239d926710e458","permalink":"/publication/microprobe/","publishdate":"2015-12-23T00:00:00Z","relpermalink":"/publication/microprobe/","section":"publication","summary":"In this study, we developed a protocol using a W‐Si multi‐layered pseudocrystal for measuring accurately trace level F in both minerals and glasses.","tags":["Source Themes"],"title":"A Practical Method for Accurate Measurement of Trace Level Fluorine in Mg‐ and Fe‐Bearing Minerals and Glasses Using Electron Probe Microanalysis","type":"publication"},{"authors":["Sören Wilke","Carolin Klahn","Torsten Bolte","Renat Almeev","Francois Holtz"],"categories":null,"content":"","date":1425168000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1425168000,"objectID":"fc7f0302959a881b59b98a8f4462b4ce","permalink":"/publication/carodata/","publishdate":"2015-03-01T00:00:00Z","relpermalink":"/publication/carodata/","section":"publication","summary":"The effect of the normative anorthite content on the position of cotectic curves in the Qz–Ab–Or–An system has been investigated at 200 MPa and a water activity of 0.5.","tags":["Source Themes"],"title":"Experimental investigation of the effect of Ca, Fe and Ti on cotectic compositions of the rhyolitic system","type":"publication"}]